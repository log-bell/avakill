# AvaKill Permissive Policy
# Log everything, block almost nothing â€” for development and audit

version: "1.0"
default_action: allow

policies:
  # --- Block catastrophic database operations ---
  - name: block-drop-database
    tools:
      - "database_*"
      - "sql_*"
    action: deny
    conditions:
      args_match:
        query: ["DROP DATABASE", "DROP SCHEMA"]
    message: "DROP DATABASE is blocked even in permissive mode"

  # --- Block catastrophic filesystem operations ---
  - name: block-rm-rf-root
    tools:
      - "shell_*"
      - "bash_*"
      - "command_*"
    action: deny
    conditions:
      args_match:
        cmd: ["rm -rf /"]
    message: "rm -rf / is blocked even in permissive mode"

  # --- Block filesystem writes via MCP ---
  - name: block-mcp-writes
    tools:
      - "write_file"
      - "edit_file"
      - "create_directory"
      - "move_file"
    action: deny
    message: "Filesystem writes blocked by AvaKill policy"

  # --- Log all other tool calls (allow, with logging enabled) ---
  - name: log-everything
    tools:
      - "all"
    action: allow
    log: true
    message: "Allowed (audit logged)"
