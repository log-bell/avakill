# AgentGuard Strict Policy
# Maximum safety â€” deny by default, explicit allowlist only

version: "1.0"
default_action: deny

policies:
  # --- Only allow explicit read operations ---
  - name: allow-reads-only
    tools:
      - "*_read"
      - "*_get"
      - "*_list"
    action: allow
    rate_limit:
      max_calls: 10
      window: "1m"
    message: "Read operations allowed (rate limited)"

  # --- All write operations require approval ---
  - name: writes-require-approval
    tools:
      - "*_write"
      - "*_create"
      - "*_update"
      - "*_put"
      - "*_post"
    action: require_approval
    rate_limit:
      max_calls: 10
      window: "1m"
    message: "Write operations require human approval"

  # --- All execution requires approval ---
  - name: execution-requires-approval
    tools:
      - "*_execute"
      - "shell_*"
      - "bash_*"
      - "command_*"
      - "code_*"
    action: require_approval
    rate_limit:
      max_calls: 10
      window: "1m"
    message: "Execution operations require human approval"

  # --- Block all destructive operations ---
  - name: block-destructive
    tools:
      - "*_delete"
      - "*_drop"
      - "*_destroy"
      - "*_remove"
    action: deny
    message: "Destructive operations are blocked in strict mode"
