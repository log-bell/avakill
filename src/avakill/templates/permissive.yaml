# AvaKill Permissive Policy
# Log everything, block almost nothing â€” for development and audit
#
# Includes native tool names from popular AI coding agents:
#   Claude Code, Gemini CLI, Cursor, Windsurf, OpenAI Codex

version: "1.0"
default_action: allow

policies:
  # --- Block catastrophic database operations ---
  - name: block-drop-database
    tools:
      - "database_*"
      - "sql_*"
    action: deny
    conditions:
      args_match:
        query: ["DROP DATABASE", "DROP SCHEMA"]
    message: "DROP DATABASE is blocked even in permissive mode"

  # --- Block catastrophic filesystem operations ---
  - name: block-rm-rf-root
    tools:
      # Canonical
      - "shell_execute"
      # Claude Code
      - "Bash"
      # Gemini CLI
      - "run_shell_command"
      # Windsurf
      - "run_command"
      # OpenAI Codex
      - "shell"
      - "local_shell"
      - "exec_command"
      # Generic globs
      - "shell_*"
      - "bash_*"
      - "command_*"
    action: deny
    conditions:
      args_match:
        command: ["rm -rf /"]
    message: "rm -rf / is blocked even in permissive mode"

  # --- Log all other tool calls (allow, with logging enabled) ---
  - name: log-everything
    tools:
      - "all"
    action: allow
    log: true
    message: "Allowed (audit logged)"
