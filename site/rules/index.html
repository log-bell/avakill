<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rule Catalog — AvaKill</title>
  <meta name="description" content="AvaKill's complete rule catalog: 80+ safety rules across 10 categories protecting AI coding agents from catastrophic operations.">
  <meta name="theme-color" content="#0A0F1E">
  <meta property="og:title" content="Rule Catalog — AvaKill">
  <meta property="og:description" content="Every rule AvaKill enforces to keep AI agents from destroying your system, data, and credentials.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://avakill.com/rules">
  <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg">
  <link rel="shortcut icon" href="/favicon/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <link rel="manifest" href="/favicon/site.webmanifest">
  <link href="https://api.fontshare.com/v2/css?f[]=satoshi@400,500,700,900&display=swap" rel="stylesheet">
  <style>
    /* =========================================================
       CSS Custom Properties (matching landing page)
       ========================================================= */
    :root {
      --neon-blue: #00D4FF;
      --neon-blue-bright: #00F5FF;
      --neon-blue-dim: #0088CC;
      --base-dark: #0A0F1E;
      --surface: #111827;
      --surface-elevated: #1A1F3A;
      --subtle-blue-tint: #0D1B3D;
      --text-primary: #F8F8F8;
      --text-secondary: #9CA3AF;
      --text-muted: #6B7280;
      --color-allowed: #22C55E;
      --color-denied: #EF4444;
      --color-pending: #F59E0B;
      --color-info: #00D4FF;
      --navy-black: #0B1029;
      --navy-mid: #1A1F45;
      --cool-gray: #C8CCD8;
      --code-bg: #0D1117;
      --code-text: #E6EDF3;
    }

    /* =========================================================
       Reset & Base
       ========================================================= */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'Satoshi', system-ui, -apple-system, sans-serif;
      background: var(--base-dark);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Noise overlay */
    body::after {
      content: '';
      position: fixed;
      inset: 0;
      z-index: 999;
      pointer-events: none;
      opacity: 0.035;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
      background-size: 256px 256px;
    }

    /* =========================================================
       Navigation
       ========================================================= */
    .site-nav {
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 1000;
      height: 56px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 24px;
      background: rgba(10, 15, 30, 0.85);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-bottom: 1px solid transparent;
      transition: border-color 0.3s ease;
    }
    .site-nav.scrolled { border-bottom-color: rgba(0, 212, 255, 0.1); }
    .nav-brand {
      font-size: 1.1rem; font-weight: 900;
      color: var(--neon-blue); text-decoration: none;
      letter-spacing: -0.02em; flex-shrink: 0;
    }
    .nav-links { display: flex; align-items: center; gap: 28px; }
    .nav-links a {
      color: var(--text-secondary); text-decoration: none;
      font-size: 0.85rem; font-weight: 500; transition: color 0.2s ease;
    }
    .nav-links a:hover, .nav-links a.active { color: var(--neon-blue); }
    .nav-hamburger {
      display: none; background: none; border: none;
      cursor: pointer; padding: 4px; flex-direction: column; gap: 5px;
    }
    .nav-hamburger span {
      display: block; width: 20px; height: 2px;
      background: var(--text-secondary); border-radius: 2px;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    /* =========================================================
       Page Hero
       ========================================================= */
    .page-hero {
      position: relative; z-index: 1;
      padding: 140px 24px 60px;
      text-align: center;
      max-width: 900px;
      margin: 0 auto;
    }
    .page-hero::before {
      content: '';
      position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background: radial-gradient(ellipse at 50% 30%, var(--subtle-blue-tint) 0%, transparent 60%);
      pointer-events: none; z-index: -1;
    }
    .page-hero h1 {
      font-size: clamp(2rem, 5vw, 3.2rem);
      font-weight: 900; letter-spacing: -0.03em;
      line-height: 1.1; margin-bottom: 20px;
      animation: fadeUp 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards;
      opacity: 0;
    }
    .page-hero h1 .accent { color: var(--neon-blue); }
    .page-hero .subtitle {
      max-width: 700px; margin: 0 auto 32px;
      color: var(--text-secondary); font-size: 1.05rem; line-height: 1.7;
      animation: fadeUp 0.7s cubic-bezier(0.16, 1, 0.3, 1) 0.15s forwards;
      opacity: 0;
    }
    .page-hero .hero-stats {
      display: flex; justify-content: center; gap: 32px; flex-wrap: wrap;
      animation: fadeUp 0.7s cubic-bezier(0.16, 1, 0.3, 1) 0.3s forwards;
      opacity: 0;
    }
    .stat-item {
      display: flex; flex-direction: column; align-items: center; gap: 4px;
    }
    .stat-number {
      font-size: 2rem; font-weight: 900; color: var(--neon-blue);
      line-height: 1;
    }
    .stat-label {
      font-size: 0.75rem; font-weight: 600; color: var(--text-muted);
      text-transform: uppercase; letter-spacing: 0.1em;
    }

    @keyframes fadeUp {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    /* =========================================================
       Content Container
       ========================================================= */
    .content {
      position: relative; z-index: 1;
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 24px 100px;
    }

    /* =========================================================
       Section Headers
       ========================================================= */
    .section-divider {
      max-width: 1100px;
      margin: 80px auto 0;
      border: none; height: 1px;
      background: rgba(0, 212, 255, 0.1);
    }

    .section-anchor {
      scroll-margin-top: 80px;
    }

    .section-head {
      display: flex; align-items: flex-start; gap: 16px;
      margin-bottom: 12px; margin-top: 60px;
    }
    .section-num {
      flex-shrink: 0;
      width: 36px; height: 36px;
      display: flex; align-items: center; justify-content: center;
      background: rgba(0, 212, 255, 0.1);
      border: 1px solid rgba(0, 212, 255, 0.2);
      border-radius: 10px;
      font-size: 0.85rem; font-weight: 700; color: var(--neon-blue);
    }
    .section-head h2 {
      font-size: clamp(1.3rem, 2.5vw, 1.8rem);
      font-weight: 700; letter-spacing: -0.02em;
      line-height: 1.2; padding-top: 4px;
    }
    .section-desc {
      color: var(--text-secondary); font-size: 0.95rem;
      line-height: 1.7; margin-bottom: 24px; max-width: 800px;
    }

    /* =========================================================
       Info Cards (used for intro sections)
       ========================================================= */
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px; margin-bottom: 40px;
    }
    .info-card {
      background: var(--surface);
      border: 1px solid rgba(0, 212, 255, 0.1);
      border-radius: 14px; padding: 28px;
      opacity: 0; transform: translateY(12px);
      transition: opacity 0.5s ease, transform 0.5s ease, border-color 0.3s ease;
    }
    .info-card.visible {
      opacity: 1; transform: translateY(0);
    }
    .info-card:hover {
      border-color: rgba(0, 212, 255, 0.25);
    }
    .info-card h3 {
      font-size: 1rem; font-weight: 700; margin-bottom: 10px;
      color: var(--text-primary);
    }
    .info-card h3 .dot {
      display: inline-block; width: 8px; height: 8px;
      border-radius: 50%; margin-right: 8px;
    }
    .info-card p, .info-card ul {
      font-size: 0.875rem; color: var(--text-secondary);
      line-height: 1.7;
    }
    .info-card ul {
      list-style: none; padding: 0;
    }
    .info-card li {
      padding: 4px 0; display: flex; align-items: baseline; gap: 8px;
    }
    .info-card li::before {
      content: ''; width: 6px; height: 6px; flex-shrink: 0;
      border-radius: 50%; margin-top: 6px;
    }

    /* =========================================================
       Deny Message Block
       ========================================================= */
    .deny-block {
      background: var(--code-bg);
      border: 1px solid rgba(0, 212, 255, 0.08);
      border-radius: 12px; overflow: hidden;
      margin-bottom: 40px;
    }
    .deny-titlebar {
      height: 36px; background: #161B22;
      display: flex; align-items: center; padding: 0 16px; gap: 8px;
    }
    .deny-dot { width: 10px; height: 10px; border-radius: 50%; }
    .deny-dot--red { background: #EF4444; }
    .deny-dot--yellow { background: #F59E0B; }
    .deny-dot--green { background: #22C55E; }
    .deny-titlebar span:last-child {
      margin-left: auto; font-size: 0.7rem; color: var(--text-muted);
    }
    .deny-body {
      padding: 24px;
      font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
      font-size: 0.8rem; line-height: 1.8;
      color: var(--code-text); white-space: pre-wrap;
    }
    .deny-body .red { color: var(--color-denied); font-weight: 700; }
    .deny-body .muted { color: var(--text-muted); }
    .deny-body .blue { color: var(--neon-blue); }
    .deny-body .green { color: var(--color-allowed); }
    .deny-body .yellow { color: var(--color-pending); }

    /* =========================================================
       Design Principles
       ========================================================= */
    .principles {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 16px; margin-top: 24px; margin-bottom: 40px;
    }
    .principle {
      background: var(--surface);
      border-left: 3px solid var(--neon-blue);
      border-radius: 0 12px 12px 0;
      padding: 20px 24px;
      opacity: 0; transform: translateY(12px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .principle.visible { opacity: 1; transform: translateY(0); }
    .principle h4 {
      font-size: 0.85rem; font-weight: 700;
      color: var(--neon-blue); margin-bottom: 6px;
      font-family: 'SF Mono', 'Fira Code', monospace;
    }
    .principle p {
      font-size: 0.875rem; color: var(--text-secondary); line-height: 1.6;
    }

    /* =========================================================
       Rule Tables
       ========================================================= */
    .rule-table-wrap {
      overflow-x: auto; margin-bottom: 20px;
      border-radius: 12px;
      border: 1px solid rgba(0, 212, 255, 0.08);
    }
    .rule-table {
      width: 100%; border-collapse: collapse;
      font-size: 0.82rem; min-width: 700px;
    }
    .rule-table thead {
      background: #161B22;
    }
    .rule-table th {
      padding: 12px 16px;
      text-align: left; font-weight: 700;
      color: var(--text-muted);
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      border-bottom: 1px solid rgba(0, 212, 255, 0.08);
      white-space: nowrap;
    }
    .rule-table td {
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.03);
      vertical-align: top;
      color: var(--text-secondary);
      line-height: 1.6;
    }
    .rule-table tbody tr:last-child td {
      border-bottom: none;
    }
    .rule-table tbody tr {
      background: var(--code-bg);
      transition: background 0.2s ease;
    }
    .rule-table tbody tr:hover {
      background: rgba(0, 212, 255, 0.03);
    }
    .rule-name {
      font-family: 'SF Mono', 'Fira Code', monospace;
      font-weight: 700; font-size: 0.78rem;
      color: var(--text-primary); white-space: nowrap;
    }
    .rule-blocks code {
      font-family: 'SF Mono', 'Fira Code', monospace;
      font-size: 0.75rem;
      background: rgba(0, 212, 255, 0.06);
      padding: 1px 5px; border-radius: 3px;
      color: var(--neon-blue);
    }

    /* Tier badges */
    .tier {
      display: inline-flex; align-items: center; justify-content: center;
      font-size: 0.7rem; font-weight: 700;
      padding: 2px 8px; border-radius: 4px;
      white-space: nowrap;
    }
    .tier--1 { background: rgba(34, 197, 94, 0.15); color: #22C55E; }
    .tier--2 { background: rgba(0, 212, 255, 0.15); color: #00D4FF; }
    .tier--3 { background: rgba(245, 158, 11, 0.15); color: #F59E0B; }
    .tier--4 { background: rgba(168, 85, 247, 0.15); color: #A855F7; }
    .tier--5 { background: rgba(239, 68, 68, 0.15); color: #EF4444; }

    /* Action badges */
    .action {
      display: inline-flex; align-items: center; justify-content: center;
      font-size: 0.7rem; font-weight: 700;
      padding: 2px 8px; border-radius: 4px;
      white-space: nowrap;
    }
    .action--deny { background: rgba(239, 68, 68, 0.15); color: #EF4444; }
    .action--ask { background: rgba(245, 158, 11, 0.15); color: #F59E0B; }
    .action--allow { background: rgba(34, 197, 94, 0.15); color: #22C55E; }

    /* Default badges */
    .default-badge {
      display: inline-flex; align-items: center; justify-content: center;
      font-size: 0.7rem; font-weight: 700;
      padding: 2px 8px; border-radius: 4px;
      white-space: nowrap;
    }
    .default--on { background: rgba(34, 197, 94, 0.15); color: #22C55E; }
    .default--off { background: rgba(107, 114, 128, 0.15); color: #6B7280; }
    .default--base { background: rgba(0, 212, 255, 0.15); color: #00D4FF; }

    /* Incident callout */
    .incidents {
      background: rgba(239, 68, 68, 0.04);
      border: 1px solid rgba(239, 68, 68, 0.12);
      border-radius: 10px; padding: 16px 20px;
      margin-bottom: 16px;
    }
    .incidents-label {
      font-size: 0.7rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: 0.1em;
      color: var(--color-denied); margin-bottom: 8px;
    }
    .incidents p {
      font-size: 0.85rem; color: var(--text-secondary); line-height: 1.7;
    }

    /* =========================================================
       Platform Tabs
       ========================================================= */
    .platform-tabs {
      display: flex; gap: 4px; margin-bottom: 20px;
    }
    .platform-tab {
      padding: 8px 20px;
      font-size: 0.8rem; font-weight: 600;
      color: var(--text-muted);
      background: transparent;
      border: 1px solid rgba(0, 212, 255, 0.1);
      border-radius: 8px;
      cursor: pointer;
      font-family: inherit;
      transition: all 0.2s ease;
    }
    .platform-tab:hover { color: var(--text-secondary); border-color: rgba(0, 212, 255, 0.2); }
    .platform-tab.active {
      background: rgba(0, 212, 255, 0.1);
      border-color: rgba(0, 212, 255, 0.3);
      color: var(--neon-blue);
    }
    .platform-panel { display: none; }
    .platform-panel.active { display: block; }
    .platform-threats {
      font-size: 0.82rem; color: var(--text-muted);
      line-height: 1.7; margin-top: 12px; font-style: italic;
    }

    /* =========================================================
       Roadmap Timeline
       ========================================================= */
    .roadmap {
      display: flex; flex-direction: column; gap: 0;
      margin-bottom: 40px; position: relative;
      padding-left: 28px;
    }
    .roadmap::before {
      content: ''; position: absolute;
      left: 13px; top: 0; bottom: 0;
      width: 2px; background: rgba(0, 212, 255, 0.1);
    }
    .roadmap-item {
      position: relative; padding: 20px 0 20px 24px;
      opacity: 0; transform: translateY(12px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .roadmap-item.visible { opacity: 1; transform: translateY(0); }
    .roadmap-dot {
      position: absolute; left: -22px; top: 24px;
      width: 12px; height: 12px; border-radius: 50%;
      border: 2px solid var(--neon-blue);
      background: var(--base-dark);
    }
    .roadmap-item.shipped .roadmap-dot {
      background: var(--color-allowed);
      border-color: var(--color-allowed);
    }
    .roadmap-item.blocker .roadmap-dot {
      background: var(--color-denied);
      border-color: var(--color-denied);
    }
    .roadmap-tier {
      font-size: 0.7rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: 0.1em;
      margin-bottom: 6px;
    }
    .roadmap-item.shipped .roadmap-tier { color: var(--color-allowed); }
    .roadmap-item.blocker .roadmap-tier { color: var(--color-denied); }
    .roadmap-item.planned .roadmap-tier { color: var(--text-muted); }
    .roadmap-title {
      font-size: 1.1rem; font-weight: 700;
      margin-bottom: 8px; color: var(--text-primary);
    }
    .roadmap-desc {
      font-size: 0.85rem; color: var(--text-secondary);
      line-height: 1.7;
    }
    .roadmap-rules {
      margin-top: 10px; font-size: 0.8rem;
      color: var(--text-muted); line-height: 1.8;
    }
    .roadmap-rules code {
      font-family: 'SF Mono', 'Fira Code', monospace;
      font-size: 0.75rem;
      background: rgba(0, 212, 255, 0.06);
      padding: 1px 5px; border-radius: 3px;
      color: var(--neon-blue);
    }

    /* =========================================================
       Competitive Grid
       ========================================================= */
    .competitive-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px; margin-bottom: 40px;
    }
    .competitive-card {
      background: var(--surface);
      border: 1px solid rgba(0, 212, 255, 0.1);
      border-radius: 14px; padding: 24px;
      position: relative; overflow: hidden;
      opacity: 0; transform: translateY(12px);
      transition: opacity 0.5s ease, transform 0.5s ease, border-color 0.3s ease;
    }
    .competitive-card.visible { opacity: 1; transform: translateY(0); }
    .competitive-card:hover { border-color: rgba(0, 212, 255, 0.25); }
    .competitive-card::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
      background: linear-gradient(to right, var(--neon-blue), transparent);
    }
    .competitive-num {
      font-size: 2rem; font-weight: 900;
      color: rgba(0, 212, 255, 0.15); position: absolute;
      top: 16px; right: 20px; line-height: 1;
    }
    .competitive-card h4 {
      font-size: 0.9rem; font-weight: 700;
      color: var(--text-primary); margin-bottom: 8px;
      padding-right: 40px;
    }
    .competitive-card p {
      font-size: 0.82rem; color: var(--text-secondary); line-height: 1.6;
    }

    /* =========================================================
       Defaults Summary Table
       ========================================================= */
    .defaults-table-wrap {
      overflow-x: auto; border-radius: 12px;
      border: 1px solid rgba(0, 212, 255, 0.08);
      margin-bottom: 32px;
    }
    .defaults-table {
      width: 100%; border-collapse: collapse;
      font-size: 0.85rem; min-width: 550px;
    }
    .defaults-table thead { background: #161B22; }
    .defaults-table th {
      padding: 14px 20px; text-align: left;
      font-weight: 700; color: var(--text-muted);
      font-size: 0.7rem; text-transform: uppercase;
      letter-spacing: 0.08em;
      border-bottom: 1px solid rgba(0, 212, 255, 0.08);
    }
    .defaults-table td {
      padding: 14px 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.03);
      color: var(--text-secondary);
    }
    .defaults-table tbody tr { background: var(--code-bg); }
    .defaults-table tbody tr:hover { background: rgba(0, 212, 255, 0.03); }
    .defaults-table tbody tr:last-child td { border-bottom: none; }
    .defaults-table .cat-name {
      font-weight: 700; color: var(--text-primary);
    }

    /* Incident coverage list */
    .incident-coverage {
      background: var(--surface);
      border: 1px solid rgba(0, 212, 255, 0.1);
      border-radius: 14px; padding: 28px;
    }
    .incident-coverage h3 {
      font-size: 1rem; font-weight: 700;
      margin-bottom: 16px; color: var(--text-primary);
    }
    .incident-list {
      list-style: none; padding: 0;
    }
    .incident-list li {
      display: flex; gap: 12px;
      padding: 8px 0; font-size: 0.85rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.03);
      line-height: 1.6;
    }
    .incident-list li:last-child { border-bottom: none; }
    .incident-name {
      color: var(--color-denied); font-weight: 600;
      min-width: 260px; flex-shrink: 0;
    }
    .incident-rule {
      color: var(--text-muted);
    }
    .incident-rule code {
      font-family: 'SF Mono', 'Fira Code', monospace;
      font-size: 0.75rem;
      background: rgba(0, 212, 255, 0.06);
      padding: 1px 5px; border-radius: 3px;
      color: var(--neon-blue);
    }

    /* =========================================================
       TOC Sidebar (desktop)
       ========================================================= */
    .page-layout {
      display: flex; gap: 48px;
      max-width: 1200px; margin: 0 auto;
      padding: 0 24px 100px;
      position: relative;
    }
    .toc-sidebar {
      position: sticky; top: 80px;
      width: 220px; flex-shrink: 0;
      height: fit-content;
      max-height: calc(100vh - 100px);
      overflow-y: auto;
    }
    .toc-label {
      font-size: 0.65rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: 0.15em;
      color: var(--text-muted); margin-bottom: 12px;
    }
    .toc-list {
      list-style: none; padding: 0;
    }
    .toc-list li { margin-bottom: 2px; }
    .toc-list a {
      display: block; padding: 6px 12px;
      font-size: 0.78rem; font-weight: 500;
      color: var(--text-muted);
      text-decoration: none;
      border-radius: 6px;
      border-left: 2px solid transparent;
      transition: all 0.2s ease;
      line-height: 1.4;
    }
    .toc-list a:hover {
      color: var(--text-secondary);
      background: rgba(0, 212, 255, 0.04);
    }
    .toc-list a.active {
      color: var(--neon-blue);
      border-left-color: var(--neon-blue);
      background: rgba(0, 212, 255, 0.06);
    }
    .toc-list .toc-sub {
      padding-left: 24px; font-size: 0.72rem;
    }
    .main-content {
      flex: 1; min-width: 0;
    }

    /* =========================================================
       Footer
       ========================================================= */
    .footer {
      position: relative; z-index: 1;
      padding: 60px 24px 40px; text-align: center;
    }
    .footer-links {
      display: flex; align-items: center; justify-content: center;
      flex-wrap: wrap; gap: 0; font-size: 0.9rem;
    }
    .footer-links a {
      color: var(--neon-blue); text-decoration: none;
      transition: text-decoration-color 0.2s ease;
    }
    .footer-links a:hover { text-decoration: underline; }
    .footer-links .sep { color: var(--text-muted); margin: 0 12px; }
    .footer-attribution {
      margin-top: 24px; font-size: 0.8rem;
      color: var(--text-muted); line-height: 1.7;
    }
    .footer-line {
      max-width: 864px; margin: 32px auto 0;
      border: none; height: 1px;
      background: rgba(0, 212, 255, 0.1);
    }

    /* =========================================================
       Responsive
       ========================================================= */
    @media (max-width: 1024px) {
      .toc-sidebar { display: none; }
      .page-layout { display: block; }
    }

    @media (max-width: 768px) {
      .nav-links { display: none; }
      .nav-hamburger { display: flex; }
      .site-nav.nav-open .nav-links {
        display: flex; flex-direction: column;
        position: absolute; top: 56px; left: 0; right: 0;
        background: rgba(10, 15, 30, 0.95);
        backdrop-filter: blur(12px);
        padding: 16px 24px 24px; gap: 12px;
      }
      .page-hero { padding: 120px 20px 40px; }
      .page-hero .hero-stats { gap: 20px; }
      .stat-number { font-size: 1.5rem; }
      .section-head h2 { font-size: 1.3rem; }
      .info-grid { grid-template-columns: 1fr; }
      .principles { grid-template-columns: 1fr; }
      .competitive-grid { grid-template-columns: 1fr; }
      .rule-table { font-size: 0.75rem; }
      .rule-table th, .rule-table td { padding: 10px 12px; }
      .incident-list li { flex-direction: column; gap: 4px; }
      .incident-name { min-width: auto; }
      .platform-tabs { flex-wrap: wrap; }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* =========================================================
       Accessibility
       ========================================================= */
    .sr-only {
      position: absolute; width: 1px; height: 1px;
      padding: 0; margin: -1px; overflow: hidden;
      clip: rect(0,0,0,0); white-space: nowrap; border: 0;
    }
  </style>
</head>
<body>

  <!-- Navigation -->
  <header class="site-nav" id="site-nav">
    <a href="/" class="nav-brand">AvaKill</a>
    <nav class="nav-links">
      <a href="/">Home</a>
      <a href="/rules" class="active">Rules</a>
      <a href="https://github.com/log-bell/avakill/blob/main/docs/getting-started.md">Docs</a>
      <a href="https://github.com/log-bell/avakill">GitHub</a>
    </nav>
    <button class="nav-hamburger" id="nav-hamburger" aria-label="Toggle menu">
      <span></span><span></span><span></span>
    </button>
  </header>

  <!-- Page Hero -->
  <section class="page-hero">
    <h1><span class="accent">Rule Catalog</span>: Product Vision &amp; Roadmap</h1>
    <p class="subtitle">
      Every rule AvaKill will enforce &mdash; organized by category, tagged by engine tier, and mapped to real-world incidents.
      This is what ships now, what ships next, and what we're building toward.
    </p>
    <div class="hero-stats">
      <div class="stat-item">
        <span class="stat-number">80+</span>
        <span class="stat-label">Rules</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">10</span>
        <span class="stat-label">Categories</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">5</span>
        <span class="stat-label">Engine Tiers</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">18+</span>
        <span class="stat-label">Incidents Covered</span>
      </div>
    </div>
  </section>

  <!-- Main Layout: TOC + Content -->
  <div class="page-layout">

    <!-- Sticky Table of Contents -->
    <aside class="toc-sidebar" id="toc-sidebar">
      <div class="toc-label">On this page</div>
      <ul class="toc-list">
        <li><a href="#how-it-works">How This Works</a></li>
        <li><a href="#deny-messages">Deny Messages</a></li>
        <li><a href="#cat-1" class="toc-sub">1. Filesystem Protection</a></li>
        <li><a href="#cat-2" class="toc-sub">2. Shell Safety</a></li>
        <li><a href="#cat-3" class="toc-sub">3. Write Protection</a></li>
        <li><a href="#cat-4" class="toc-sub">4. Database Safety</a></li>
        <li><a href="#cat-5" class="toc-sub">5. Version Control</a></li>
        <li><a href="#cat-6" class="toc-sub">6. Supply Chain</a></li>
        <li><a href="#cat-7" class="toc-sub">7. Network &amp; Exfil</a></li>
        <li><a href="#cat-8" class="toc-sub">8. Secrets</a></li>
        <li><a href="#cat-9" class="toc-sub">9. Cloud &amp; Infra</a></li>
        <li><a href="#cat-10" class="toc-sub">10. AI Agent Threats</a></li>
        <li><a href="#os-hardening" class="toc-sub">OS Hardening</a></li>
        <li><a href="#roadmap">Roadmap</a></li>
        <li><a href="#competitive">Competitive Positioning</a></li>
        <li><a href="#defaults">Recommended Defaults</a></li>
      </ul>
    </aside>

    <!-- Main Content -->
    <div class="main-content">

      <!-- ============================================================
           HOW THIS DOCUMENT IS STRUCTURED
           ============================================================ -->
      <div id="how-it-works" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num">&lt;/&gt;</div>
        <h2>How This Works</h2>
      </div>
      <p class="section-desc">
        Every major AI coding agent shipped in 2024&ndash;2025 has caused documented catastrophic data loss. Claude Code deleted entire home directories via tilde expansion. Google's Gemini-powered IDE wiped a user's D: drive. Cursor's denylist was proven trivially bypassable and subsequently removed entirely. AvaKill fills the gap no existing tool covers: tool-call interception.
      </p>
      <p class="section-desc" style="margin-top: -12px;">
        The setup wizard gives you <strong>category-level toggles</strong> for the 90% case, and <strong>expandable individual rules</strong> for fine-grained control &mdash; without ever touching YAML.
      </p>

      <div class="info-grid">
        <!-- Categories -->
        <div class="info-card">
          <h3><span class="dot" style="background: var(--neon-blue);"></span>Categories + Expandable Rules</h3>
          <p>The setup wizard presents <strong>10 categories</strong> as toggles. Most users toggle a category and move on. Users who need fine-grained control <strong>expand a category</strong> to customize individual rules within it. No YAML editing required.</p>
        </div>

        <!-- Engine Tiers -->
        <div class="info-card">
          <h3><span class="dot" style="background: var(--color-allowed);"></span>Engine Capability Tiers</h3>
          <p>Each rule is tagged T1&ndash;T5 by the engine capability it requires. Not all rules can ship with the current substring engine. The tier tag tells you when each rule becomes available.</p>
        </div>

        <!-- Platform -->
        <div class="info-card">
          <h3><span class="dot" style="background: var(--color-pending);"></span>Platform-Detected</h3>
          <p>Platform-specific rules (macOS, Linux, Windows) are auto-detected at install time. One checkbox in the wizard &mdash; the correct rules are written per OS.</p>
        </div>
      </div>

      <!-- Setup Wizard Mockup -->
      <div class="deny-block" style="margin-top: 8px;">
        <div class="deny-titlebar">
          <span class="deny-dot deny-dot--red"></span>
          <span class="deny-dot deny-dot--yellow"></span>
          <span class="deny-dot deny-dot--green"></span>
          <span>avakill setup &mdash; rule selection</span>
        </div>
        <div class="deny-body"><span class="blue">What should AvaKill protect?</span>  <span class="muted">(toggle categories, expand for individual rules)</span>

<span class="green">[x]</span> Filesystem Protection           <span class="muted">5 of 7 rules</span>    <span class="muted">&rsaquo; Expand to customize</span>

<span class="green">[x]</span> Shell Safety                     <span class="muted">7 of 11 rules</span>
    <span class="blue">v Expanded</span>
    <span class="green">[x]</span> <span class="green">block-catastrophic-shell</span>       <span class="muted">base &mdash; always on</span>
    <span class="green">[x]</span> block-dangerous-shell          <span class="muted">rm -rf, sudo, chmod 777</span>
    <span class="green">[x]</span> block-privilege-escalation     <span class="muted">sudo, su, doas, runas</span>
    <span class="green">[x]</span> block-permission-changes       <span class="muted">chmod 777, chmod u+s</span>
    <span class="muted">[ ]</span> block-ownership-changes        <span class="muted">chown/chgrp outside workspace</span>  <span class="tier tier--2" style="font-size: 0.65rem;">T2</span>
    <span class="green">[x]</span> block-pipe-to-shell            <span class="muted">curl | bash, wget | sh</span>
    <span class="muted">[ ]</span> detect-obfuscation             <span class="muted">base64 | bash, encoded cmds</span>   <span class="tier tier--3" style="font-size: 0.65rem;">T3</span>
    <span class="muted">[ ]</span> detect-command-chaining        <span class="muted">;, &amp;&amp;, || chaining</span>            <span class="tier tier--3" style="font-size: 0.65rem;">T3</span>
    <span class="green">[x]</span> block-critical-process-kill    <span class="muted">kill -9 system processes</span>
    <span class="muted">[ ]</span> limit-command-timeout          <span class="muted">command timeout (300s)</span>
    <span class="muted">[ ]</span> shell-command-allowlist        <span class="muted">strict allowlist mode</span>

<span class="muted">[ ]</span> Database Safety                  <span class="muted">0 of 4 rules</span>    <span class="muted">&rsaquo; Expand to customize</span>
<span class="green">[x]</span> Version Control Safety           <span class="muted">3 of 3 rules</span>    <span class="muted">&rsaquo; Expand to customize</span>
<span class="green">[x]</span> Secrets &amp; Credentials            <span class="muted">7 of 7 rules</span>    <span class="muted">&rsaquo; Expand to customize</span>
<span class="muted">...</span>

<span class="yellow">Enter</span><span class="muted"> to confirm  &middot;  </span><span class="yellow">Space</span><span class="muted"> to toggle  &middot;  </span><span class="yellow">Tab</span><span class="muted"> to expand/collapse</span></div>
      </div>

      <!-- Tier Table -->
      <div class="rule-table-wrap" style="margin-top: 40px;">
        <table class="rule-table">
          <thead>
            <tr>
              <th>Tier</th>
              <th>Engine Capability</th>
              <th>Description</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="tier tier--1">T1</span></td>
              <td class="rule-name">substring</td>
              <td>Current <code>args_match</code> substring matching</td>
              <td><span class="default-badge default--on">Shipped (v0.5)</span></td>
            </tr>
            <tr>
              <td><span class="tier tier--2">T2</span></td>
              <td class="rule-name">path-resolve</td>
              <td>Expand <code>~/</code>, <code>$HOME</code>, <code>%USERPROFILE%</code>, resolve <code>../</code> and symlinks before matching</td>
              <td><span class="default-badge" style="background: rgba(239,68,68,0.15); color: #EF4444;">v1 Blocker</span></td>
            </tr>
            <tr>
              <td><span class="tier tier--3">T3</span></td>
              <td class="rule-name">command-parse</td>
              <td>Split compound commands on <code>&amp;&amp;</code>, <code>;</code>, <code>|</code>, <code>$()</code> and evaluate each segment</td>
              <td><span class="default-badge default--off">Planned</span></td>
            </tr>
            <tr>
              <td><span class="tier tier--4">T4</span></td>
              <td class="rule-name">cross-call</td>
              <td>Correlate across multiple tool calls in a session (read-encode-transmit patterns)</td>
              <td><span class="default-badge default--off">Planned</span></td>
            </tr>
            <tr>
              <td><span class="tier tier--5">T5</span></td>
              <td class="rule-name">heuristic</td>
              <td>ML/entropy-based detection (prompt injection, secret scanning)</td>
              <td><span class="default-badge default--off">Research</span></td>
            </tr>
          </tbody>
        </table>
      </div>

      <p class="section-desc" style="margin-top: 0;">
        <strong style="color: var(--color-denied);">T2 is a v1 blocker.</strong> If AvaKill ships without expanding <code style="color: var(--neon-blue); background: rgba(0,212,255,0.06); padding: 1px 5px; border-radius: 3px; font-family: monospace; font-size: 0.85rem;">~/</code> and <code style="color: var(--neon-blue); background: rgba(0,212,255,0.06); padding: 1px 5px; border-radius: 3px; font-family: monospace; font-size: 0.85rem;">$HOME</code> before evaluation, someone will hit exactly the Claude Code bug. That&rsquo;s an unacceptable blind spot for a safety product.
      </p>

      <!-- Action Mapping -->
      <div class="rule-table-wrap" style="margin-top: 32px;">
        <table class="rule-table">
          <thead>
            <tr>
              <th>Document Term</th>
              <th>AvaKill Action</th>
              <th>Behavior</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="color: var(--text-primary); font-weight: 600;">Block / hard block</td>
              <td><span class="action action--deny">deny</span></td>
              <td>Rejected immediately. No override without policy change.</td>
            </tr>
            <tr>
              <td style="color: var(--text-primary); font-weight: 600;">Require approval</td>
              <td><span class="action action--ask">ask</span></td>
              <td>Paused for human review. User can approve or reject per-call.</td>
            </tr>
            <tr>
              <td style="color: var(--text-primary); font-weight: 600;">Allow with logging</td>
              <td><span class="action action--allow">allow</span></td>
              <td>Permitted. Logged for audit trail.</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- ============================================================
           DENY MESSAGES
           ============================================================ -->
      <hr class="section-divider">
      <div id="deny-messages" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num" style="background: rgba(239,68,68,0.1); border-color: rgba(239,68,68,0.2); color: var(--color-denied);">!</div>
        <h2>Deny Messages: Two Audiences, One Design</h2>
      </div>
      <p class="section-desc">
        When AvaKill blocks a tool call, the deny message serves <strong>two audiences simultaneously</strong>: the human reading the log, and the AI agent that received the rejection. This is a core UX principle, not an implementation detail.
      </p>
      <p class="section-desc">
        <strong>The agent gets a script to relay, not a problem to solve.</strong> AI agents that receive a generic error will attempt to work around it &mdash; trying alternative commands, encoding tricks, or simply retrying. AvaKill&rsquo;s deny messages short-circuit this by giving the agent a specific message to pass to the user, and an explicit instruction to stop.
      </p>

      <div class="deny-block">
        <div class="deny-titlebar">
          <span class="deny-dot deny-dot--red"></span>
          <span class="deny-dot deny-dot--yellow"></span>
          <span class="deny-dot deny-dot--green"></span>
          <span>deny message</span>
        </div>
        <div class="deny-body"><span class="red">AvaKill blocked this tool call.</span>

  <span class="muted">Rule:</span> block-deletion-outside-workspace
  <span class="muted">Blocked:</span> rm -rf ~/Downloads/old-project
  <span class="muted">Reason:</span> Recursive deletion targets a path outside your workspace boundary

  <span class="yellow">STOP. Do not attempt to work around this block.</span>
  <span class="blue">Tell the user exactly this:</span>

  <span class="green">"AvaKill blocked a recursive deletion outside your project directory.
   To allow this specific command, run:
   avakill allow --once 'rm -rf ~/Downloads/old-project'"</span></div>
      </div>

      <div class="principles">
        <div class="principle">
          <h4>"STOP. Do not attempt to work around this block."</h4>
          <p>Prevents the agent from treating denial as a puzzle. Without this, agents try <code>rm -r</code> instead of <code>rm -rf</code>, use <code>find -delete</code>, or encode the command.</p>
        </div>
        <div class="principle">
          <h4>"Tell the user exactly this:"</h4>
          <p>Gives the agent a verbatim script. The agent becomes a relay, not an interpreter. Proven in production: AvaKill&rsquo;s self-protection rules use this pattern and agents consistently relay rather than improvise.</p>
        </div>
        <div class="principle">
          <h4>avakill allow --once '...'</h4>
          <p>The user-facing message includes the fix command. One-step override. No YAML editing, no rule hunting, no restart. Every rule includes a <code>deny_message</code> template with <code>{blocked}</code> placeholder.</p>
        </div>
      </div>


      <!-- ============================================================
           CATEGORY 1: FILESYSTEM PROTECTION
           ============================================================ -->
      <hr class="section-divider">
      <div id="cat-1" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num">1</div>
        <h2>Filesystem Protection</h2>
      </div>
      <p class="section-desc">One checkbox in the setup wizard. Covers catastrophic deletion, workspace boundary enforcement, symlink attacks, and device writes. This category alone would have prevented the Claude Code home directory deletion, Gemini CLI file losses, Google Antigravity D: drive wipe, and Claude Cowork photo deletion.</p>

      <div class="rule-table-wrap">
        <table class="rule-table">
          <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
          <tbody>
            <tr><td class="rule-name">block-catastrophic-deletion</td><td><code>rm -rf /</code>, <code>rm -rf ~/</code>, <code>rmdir /s /q C:\</code>, <code>del /s /q C:\*</code>, recursive deletion targeting any resolved absolute path. Expands <code>~/</code>, <code>$HOME</code>, and <code>../</code> before matching.</td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-destructive-disk-ops</td><td><code>dd if=/dev/zero of=/dev/sd*</code>, <code>mkfs.*</code>, <code>fdisk</code>, <code>diskutil eraseDisk</code>, <code>diskpart</code>, <code>shred /dev/*</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-deletion-outside-workspace</td><td><code>rm -rf</code>, <code>rm -r</code>, <code>rmdir /s</code>, <code>Remove-Item -Recurse</code> targeting paths outside workspace. Resolves symlinks and <code>../</code></td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-device-writes</td><td>Writes to <code>/dev/sd*</code>, <code>/dev/nvme*</code>, <code>/dev/mem</code>, <code>/dev/kmem</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-symlink-escape</td><td>Symlinks pointing outside workspace to sensitive paths. File operations following symlinks to protected paths.</td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">require-safe-delete</td><td>Flag <code>rm</code>, <code>del</code>, <code>Remove-Item</code> and suggest trash equivalents (<code>trash</code>, <code>gio trash</code>)</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--ask">ask</span></td><td><span class="default-badge default--off">off</span></td></tr>
            <tr><td class="rule-name">block-fork-bombs</td><td><code>:(){ :|:&amp; };:</code>, <code>while true; do</code>, infinite <code>fork()</code> patterns, resource exhaustion loops</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
          </tbody>
        </table>
      </div>
      <div class="incidents">
        <div class="incidents-label">Key Incidents</div>
        <p>Claude Code <code>rm -rf tests/ patches/ plan/ ~/</code> (trailing tilde expanded to home). Gemini CLI deleted project dirs when mkdir failed. Cursor YOLO mode cascaded deletions beyond project. Claude Cowork deleted 27,000 family photos. Google Antigravity IDE wiped D: drive.</p>
      </div>

      <!-- ============================================================
           CATEGORY 2: SHELL SAFETY
           ============================================================ -->
      <hr class="section-divider">
      <div id="cat-2" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num">2</div>
        <h2>Shell Safety</h2>
      </div>
      <p class="section-desc">Defense-in-depth for shell command execution &mdash; the primary attack surface for all coding agents. Includes privilege escalation, obfuscation detection, and command chaining.</p>

      <div class="rule-table-wrap">
        <table class="rule-table">
          <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
          <tbody>
            <tr><td class="rule-name">block-catastrophic-shell</td><td><code>rm -rf /</code>, <code>mkfs</code>, <code>dd if=</code>, <code>&gt; /dev/</code>, fork bombs</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--base">base</span></td></tr>
            <tr><td class="rule-name">block-dangerous-shell</td><td><code>rm -rf</code>, <code>sudo</code>, <code>chmod 777</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-destructive-tools</td><td>Tool name patterns: <code>delete_*</code>, <code>remove_*</code>, <code>destroy_*</code>, <code>drop_*</code>. Blocks by tool name regardless of arguments.</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-privilege-escalation</td><td><code>sudo</code>, <code>su</code>, <code>doas</code>, <code>runas</code>, <code>pkexec</code>, <code>Start-Process -Verb RunAs</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--ask">ask</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-permission-changes</td><td><code>chmod 777</code>, <code>chmod u+s</code> (SUID), <code>chmod -R</code> on system dirs, <code>icacls</code> granting Everyone</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-ownership-changes</td><td><code>chown</code>/<code>chgrp</code> outside workspace, especially <code>/etc/*</code>, <code>/usr/*</code>, <code>C:\Windows\*</code></td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-pipe-to-shell</td><td><code>curl | bash</code>, <code>wget | sh</code>, <code>Invoke-Expression downloadString(...)</code>. Allow-list known installers.</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">detect-obfuscation</td><td><code>base64 -d | bash</code>, <code>powershell -EncodedCommand</code>, <code>eval $(xxd -r -p)</code>, decode-to-execute patterns</td><td><span class="tier tier--3">T3</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">detect-command-chaining</td><td><code>;</code>, <code>&amp;&amp;</code>, <code>||</code>, backticks, <code>$()</code> chaining unauthorized commands after allowlisted ones</td><td><span class="tier tier--3">T3</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-critical-process-kill</td><td><code>kill -9</code>, <code>killall</code>, <code>pkill</code> targeting system processes (init, sshd, dockerd)</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">limit-command-timeout</td><td>Commands exceeding configurable timeout (default 300s). <code>nohup</code> + <code>&amp;</code> for suspicious commands.</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--off">off</span></td></tr>
            <tr><td class="rule-name">shell-command-allowlist</td><td>Only allow approved commands (echo, ls, git, python, ...). Strict mode.</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--allow">allow</span></td><td><span class="default-badge default--off">off</span></td></tr>
          </tbody>
        </table>
      </div>
      <div class="incidents">
        <div class="incidents-label">Key Incidents</div>
        <p>Buck Shlegeris&rsquo;s agent ran <code>sudo</code> to edit GRUB bootloader, bricking machine. Cursor&rsquo;s denylist bypassed via base64 encoding. Gemini CLI&rsquo;s allowlist bypassed via <code>;</code> chaining. Cursor Plan Mode killed processes on remote machines.</p>
      </div>

      <!-- ============================================================
           CATEGORY 3: FILESYSTEM WRITE PROTECTION
           ============================================================ -->
      <hr class="section-divider">
      <div id="cat-3" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num">3</div>
        <h2>Filesystem Write Protection</h2>
      </div>
      <p class="section-desc">Controls where agents can write. Prevents modification of system files, shell profiles, and startup directories. Overlapping platform-specific concerns (LaunchAgents, systemd, Windows Startup) are handled internally &mdash; the user sees one category.</p>

      <div class="rule-table-wrap">
        <table class="rule-table">
          <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
          <tbody>
            <tr><td class="rule-name">block-system-dir-writes</td><td>Writes to <code>/etc/</code>, <code>/usr/</code>, <code>/sbin/</code>, <code>/boot/</code>, <code>/System/</code>, <code>/Library/</code> (system), <code>C:\Windows\</code>, <code>C:\Program Files\</code></td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-profile-modification</td><td><code>.bashrc</code>, <code>.zshrc</code>, <code>.bash_profile</code>, <code>.profile</code>, PowerShell <code>$PROFILE</code>, <code>.env</code> outside workspace</td><td><span class="tier tier--2">T2</span></td><td><span class="action action--ask">ask</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-startup-persistence</td><td>Platform-detected: <code>~/Library/LaunchAgents/</code> (macOS), <code>/etc/systemd/system/</code> (Linux), Windows Startup folder, registry Run keys, crontab</td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">enforce-workspace-boundary</td><td>All file read/write/delete outside configured workspace. Resolves symlinks, <code>../</code>, tilde, env vars.</td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--off">off</span></td></tr>
          </tbody>
        </table>
      </div>
      <div class="incidents">
        <div class="incidents-label">Key Incidents</div>
        <p>Claude Code&rsquo;s permission system validated commands before shell expansion, allowing <code>rm -rf ~/</code> to pass. CVE-2025-53109/53110 demonstrated MCP Filesystem Server sandbox escape via path traversal.</p>
      </div>

      <!-- ============================================================
           CATEGORY 4: DATABASE SAFETY
           ============================================================ -->
      <hr class="section-divider">
      <div id="cat-4" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num">4</div>
        <h2>Database Safety</h2>
      </div>
      <p class="section-desc">Protects against destructive DDL and unqualified DML. Detects SQL in both shell tools and database tools.</p>

      <div class="rule-table-wrap">
        <table class="rule-table">
          <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
          <tbody>
            <tr><td class="rule-name">block-catastrophic-sql-shell</td><td><code>DROP DATABASE</code>, <code>DROP SCHEMA</code> via shell tools</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--base">base</span></td></tr>
            <tr><td class="rule-name">block-catastrophic-sql-db</td><td><code>DROP DATABASE</code>, <code>DROP SCHEMA</code> via database tools</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--base">base</span></td></tr>
            <tr><td class="rule-name">block-destructive-sql</td><td><code>DELETE</code>, <code>TRUNCATE</code>, <code>ALTER</code>, <code>DROP TABLE</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-unqualified-dml</td><td><code>DELETE FROM</code> / <code>UPDATE SET</code> without <code>WHERE</code> clause</td><td><span class="tier tier--3">T3</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-db-permission-changes</td><td><code>GRANT ALL</code>, <code>REVOKE</code>, <code>ALTER USER</code>, <code>CREATE USER</code>, <code>DROP USER</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--off">off</span></td></tr>
          </tbody>
        </table>
      </div>
      <div class="incidents">
        <div class="incidents-label">Key Incidents</div>
        <p>Replit agent deleted production database during code freeze. Claude Code dropped PostgreSQL databases explicitly excluded from cleanup instructions. 72% of organizations lack tested database recovery procedures.</p>
      </div>

      <!-- ============================================================
           CATEGORY 5: VERSION CONTROL SAFETY
           ============================================================ -->
      <hr class="section-divider">
      <div id="cat-5" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num">5</div>
        <h2>Version Control Safety</h2>
      </div>
      <p class="section-desc">Prevents force pushes, protected branch deletion, and credential commits.</p>

      <div class="rule-table-wrap">
        <table class="rule-table">
          <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
          <tbody>
            <tr><td class="rule-name">block-force-push</td><td><code>git push --force</code>, <code>git push -f</code> to protected branches (main/master/develop). <code>git filter-branch</code>, <code>bfg</code>.</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-branch-deletion</td><td><code>git branch -D main/master/develop</code>, <code>git push origin --delete main</code>. Configurable branch names.</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">detect-credential-commit</td><td><code>git add</code>/<code>git commit</code> staging files matching sensitive names: <code>.env</code>, <code>*.pem</code>, <code>*.key</code>, <code>id_rsa</code>, <code>credentials.json</code>. Filename substring match only (T1); content-level entropy scanning is T5/opt-in.</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
          </tbody>
        </table>
      </div>

      <!-- ============================================================
           CATEGORY 6: PACKAGE & SUPPLY CHAIN
           ============================================================ -->
      <hr class="section-divider">
      <div id="cat-6" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num">6</div>
        <h2>Package &amp; Supply Chain</h2>
      </div>
      <p class="section-desc">Controls package installation and registry configuration. Addresses OWASP LLM03 (supply chain).</p>

      <div class="rule-table-wrap">
        <table class="rule-table">
          <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
          <tbody>
            <tr><td class="rule-name">approve-package-installs</td><td><code>npm install -g</code>, <code>pip install</code> (outside venv), <code>brew install</code>, <code>apt install</code>, <code>cargo install</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--ask">ask</span></td><td><span class="default-badge default--off">off</span></td></tr>
            <tr><td class="rule-name">block-registry-manipulation</td><td><code>npm config set registry</code>, <code>pip config set global.index-url</code>, custom sources in <code>pyproject.toml</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">flag-postinstall-scripts</td><td><code>npm install</code> without <code>--ignore-scripts</code>, packages with malicious postinstall hooks</td><td><span class="tier tier--3">T3</span></td><td><span class="action action--ask">ask</span></td><td><span class="default-badge default--off">off</span></td></tr>
          </tbody>
        </table>
      </div>
      <div class="incidents">
        <div class="incidents-label">Key Incidents</div>
        <p>CVE-2025-6514 <code>mcp-remote</code> npm package (437K+ downloads) had command injection via postinstall. OWASP LLM03 ranks supply chain as top-3 LLM vulnerability.</p>
      </div>

      <!-- ============================================================
           CATEGORY 7: NETWORK & EXFILTRATION PREVENTION
           ============================================================ -->
      <hr class="section-divider">
      <div id="cat-7" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num">7</div>
        <h2>Network &amp; Exfiltration Prevention</h2>
      </div>
      <p class="section-desc">Controls outbound communication and detects data exfiltration patterns. Addresses Simon Willison&rsquo;s &ldquo;Lethal Trifecta&rdquo; (private data + untrusted content + external communication).</p>

      <div class="rule-table-wrap">
        <table class="rule-table">
          <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
          <tbody>
            <tr><td class="rule-name">restrict-outbound-http</td><td><code>curl</code>, <code>wget</code>, HTTP connections to non-allowlisted domains. Default allowlist: package registries, docs sites.</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--off">off</span></td></tr>
            <tr><td class="rule-name">block-dns-exfiltration</td><td><code>dig</code>, <code>nslookup</code> with encoded data in subdomains (<code>$(base64).attacker.com</code>)</td><td><span class="tier tier--3">T3</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-ssh-unknown-hosts</td><td><code>ssh</code> to non-allowlisted hosts, <code>scp</code> to unknown destinations, SSH config changes</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--ask">ask</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-port-binding</td><td><code>nc -l</code>, <code>socat</code>, <code>python -m http.server</code> on 0.0.0.0, privileged ports (&lt;1024)</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--off">off</span></td></tr>
            <tr><td class="rule-name">block-firewall-changes</td><td><code>iptables</code>, <code>ufw</code>, <code>pfctl</code>, <code>netsh advfirewall</code>, route manipulation, DNS config changes</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">detect-encode-transmit</td><td>Read file, base64/hex encode, send via HTTP/DNS. Cross-call correlation.</td><td><span class="tier tier--4">T4</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-browser-data-access</td><td>Chrome/Firefox/Safari profile dirs, cookie databases, saved passwords, history files</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-clipboard-exfil</td><td><code>pbcopy</code>/<code>xclip</code>/<code>Get-Clipboard</code> combined with network operations</td><td><span class="tier tier--4">T4</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--off">off</span></td></tr>
          </tbody>
        </table>
      </div>
      <div class="incidents">
        <div class="incidents-label">Key Incidents</div>
        <p>CVE-2025-55284 Claude Code DNS exfiltration via prompt injection. CamoLeak attack used Copilot to exfiltrate secrets from private repos. Buck Shlegeris&rsquo;s agent SSH&rsquo;d into desktop and bricked it.</p>
      </div>

      <!-- ============================================================
           CATEGORY 8: SECRETS & CREDENTIALS
           ============================================================ -->
      <hr class="section-divider">
      <div id="cat-8" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num">8</div>
        <h2>Secrets &amp; Credentials</h2>
      </div>
      <p class="section-desc">Blocks access to sensitive credential files and detects secrets in outbound data.</p>

      <div class="rule-table-wrap">
        <table class="rule-table">
          <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
          <tbody>
            <tr><td class="rule-name">block-ssh-key-access</td><td><code>~/.ssh/id_rsa</code>, <code>~/.ssh/id_ed25519</code>, <code>~/.ssh/*.pem</code>, <code>~/.ssh/authorized_keys</code>, <code>~/.ssh/config</code></td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-cloud-credentials</td><td><code>~/.aws/credentials</code>, <code>~/.gcloud/</code>, <code>~/.azure/</code>, <code>~/.kube/config</code>, <code>~/.docker/config.json</code></td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-env-outside-workspace</td><td><code>.env</code>, <code>.env.local</code>, <code>.env.production</code> outside workspace. <code>printenv</code>/<code>env</code> piped to other commands.</td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-sensitive-file-access</td><td><code>.env</code>, <code>.ssh/</code>, <code>.aws/</code>, <code>.gnupg/</code>, <code>credentials.json</code>, <code>serviceAccountKey.json</code>, <code>.pem</code>, <code>.key</code> files</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--off">off</span></td></tr>
            <tr><td class="rule-name">detect-secrets-outbound</td><td>Regex + entropy scan of outbound data for API keys (<code>sk-*</code>, <code>AKIA*</code>, <code>ghp_*</code>), tokens, private keys</td><td><span class="tier tier--5">T5</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-credential-stores</td><td>macOS Keychain (<code>security dump-keychain</code>), Linux <code>~/.gnupg/</code>, Windows Credential Manager (<code>cmdkey</code>, <code>vaultcmd</code>)</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-path-poisoning</td><td><code>export PATH=/tmp:$PATH</code>, <code>export PATH=.:$PATH</code>, untrusted PATH prepends</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-env-secret-exposure</td><td><code>printenv</code>, <code>env</code>, <code>set</code> piped/redirected when containing <code>$AWS_SECRET_ACCESS_KEY</code>, <code>$API_KEY</code>, etc.</td><td><span class="tier tier--3">T3</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
          </tbody>
        </table>
      </div>
      <div class="incidents">
        <div class="incidents-label">Key Incidents</div>
        <p>Claude Code path traversal bug (issue #1585) allowed <code>~/.ssh/</code> access. Amazon Q supply chain attack (CVE-2025-8217) included S3 bucket deletion instructions. EnrichLead incident exposed all API keys in frontend code.</p>
      </div>

      <!-- ============================================================
           CATEGORY 9: CLOUD & INFRASTRUCTURE
           ============================================================ -->
      <hr class="section-divider">
      <div id="cat-9" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num">9</div>
        <h2>Cloud &amp; Infrastructure</h2>
      </div>
      <p class="section-desc">Protects cloud resources, containers, and orchestration. Addresses the blast radius when agents have cloud CLI access.</p>

      <div class="rule-table-wrap">
        <table class="rule-table">
          <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
          <tbody>
            <tr><td class="rule-name">block-cloud-resource-deletion</td><td><code>aws s3 rm/rb</code>, <code>aws ec2 terminate-instances</code>, <code>gcloud compute instances delete</code>, <code>terraform destroy</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--ask">ask</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-iam-changes</td><td><code>aws iam</code>, <code>gcloud iam</code>, <code>az role</code>, security groups open to 0.0.0.0/0</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--off">off</span></td></tr>
            <tr><td class="rule-name">block-backup-deletion</td><td><code>aws rds delete-db-snapshot</code>, <code>aws ec2 delete-snapshot</code>, snapshot deletion in any cloud provider</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-destructive-docker</td><td><code>docker system prune -af</code>, <code>docker volume rm</code>, bulk container/image deletion</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--ask">ask</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-container-escape</td><td><code>docker run --privileged</code>, <code>-v /:/host</code>, <code>nsenter --target 1</code>, Docker socket access</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-k8s-destruction</td><td><code>kubectl delete namespace/deployment/pvc/node</code>, <code>helm uninstall</code> in production namespaces</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--off">off</span></td></tr>
          </tbody>
        </table>
      </div>
      <div class="incidents">
        <div class="incidents-label">Key Incidents</div>
        <p>Amazon Kiro deleted and recreated a production environment, causing 13-hour AWS outage. Amazon Q supply chain attack included S3 bucket deletion instructions.</p>
      </div>

      <!-- ============================================================
           CATEGORY 10: AI AGENT THREATS
           ============================================================ -->
      <hr class="section-divider">
      <div id="cat-10" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num">10</div>
        <h2>AI Agent Threats</h2>
      </div>
      <p class="section-desc">Rules informed by OWASP Top 10 for LLMs (2025) and MITRE ATLAS. Addresses threats unique to AI agent architectures: prompt injection, MCP tool poisoning, self-modification, and unbounded consumption.</p>

      <div class="rule-table-wrap">
        <table class="rule-table">
          <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
          <tbody>
            <tr><td class="rule-name">detect-mcp-tool-poisoning</td><td>Hidden instructions in MCP tool descriptions, invisible Unicode, tool definition mutations after approval</td><td><span class="tier tier--3">T3</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">block-agent-self-modification</td><td>Agent modifying <code>.claude/settings.json</code>, <code>.cursor/mcp.json</code>, <code>.gemini/settings.json</code>, AvaKill policy YAML</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">rate-limit-tool-calls</td><td>Configurable: total calls/session (500), deletions/min (10), writes/min (50), shell/min (20), network/min (30)</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            <tr><td class="rule-name">rate-limit-web-search</td><td>Web search tool calls (default: 30/min)</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--allow">allow</span></td><td><span class="default-badge default--off">off</span></td></tr>
            <tr><td class="rule-name">rate-limit-agent-spawn</td><td>Agent/task spawning (default: 20/min)</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--allow">allow</span></td><td><span class="default-badge default--off">off</span></td></tr>
            <tr><td class="rule-name">require-file-write-approval</td><td>All write/edit tools require human approval</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--ask">ask</span></td><td><span class="default-badge default--off">off</span></td></tr>
            <tr><td class="rule-name">detect-prompt-injection</td><td>Files containing instruction-like patterns (&ldquo;ignore previous instructions&rdquo;, encoded instructions in comments)</td><td><span class="tier tier--5">T5</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--off">off</span></td></tr>
            <tr><td class="rule-name">detect-behavioral-anomaly</td><td>Read-encode-transmit sequences, rapid sequential deletions, deviation from stated task</td><td><span class="tier tier--4">T4</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--off">off</span></td></tr>
          </tbody>
        </table>
      </div>
      <div class="incidents">
        <div class="incidents-label">Key Incidents</div>
        <p>84.2% attack success rate for MCP tool poisoning with auto-approval. 43% of public MCP servers have command injection flaws. Copilot and Claude demonstrated rewriting each other&rsquo;s config files in privilege escalation loop. OWASP LLM10 unbounded consumption.</p>
      </div>

      <!-- ============================================================
           OS SECURITY HARDENING
           ============================================================ -->
      <hr class="section-divider">
      <div id="os-hardening" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num" style="background: rgba(245,158,11,0.1); border-color: rgba(245,158,11,0.2); color: var(--color-pending);">OS</div>
        <h2>OS Security Hardening <span style="font-size: 0.7em; color: var(--text-muted); font-weight: 500;">(platform-detected)</span></h2>
      </div>
      <p class="section-desc">One checkbox in the setup wizard. Platform detection at install time writes the correct rules. A macOS user sees &ldquo;OS Security Hardening&rdquo; and gets LaunchAgent/SIP/TCC rules. A Linux user gets SELinux/systemd/kernel rules. A Windows user gets Defender/VSS/UAC rules. Internally these are separate rules; externally they&rsquo;re one category.</p>

      <!-- Platform tabs -->
      <div class="platform-tabs">
        <button class="platform-tab active" data-platform="macos">macOS</button>
        <button class="platform-tab" data-platform="linux">Linux</button>
        <button class="platform-tab" data-platform="windows">Windows</button>
      </div>

      <!-- macOS Panel -->
      <div class="platform-panel active" id="platform-macos">
        <div class="rule-table-wrap">
          <table class="rule-table">
            <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
            <tbody>
              <tr><td class="rule-name">block-sip-changes</td><td><code>csrutil disable</code>, <code>csrutil authenticated-root disable</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-tcc-manipulation</td><td>Direct TCC.db access, <code>tccutil reset</code>, SQLite on TCC databases</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-gatekeeper-bypass</td><td><code>xattr -d com.apple.quarantine</code>, <code>spctl --master-disable</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--ask">ask</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-launchagent-creation</td><td>.plist writes to LaunchAgents/LaunchDaemons dirs, <code>launchctl load/bootstrap</code></td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-osascript-abuse</td><td><code>osascript -e</code> with <code>do shell script</code>, dialog phishing, AppleEvent access to other apps</td><td><span class="tier tier--3">T3</span></td><td><span class="action action--ask">ask</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-defaults-security</td><td><code>defaults write</code> targeting security domains (LSQuarantine, alf globalstate)</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            </tbody>
          </table>
        </div>
        <p class="platform-threats">Key threats: CVE-2024-44243 / CVE-2023-32369 SIP bypasses. XCSSET malware targeting TCC. UpdateAgent/Shlayer/OceanLotus using Gatekeeper bypass. CVE-2025-43530 TCC bypass via VoiceOver + AppleScript.</p>
      </div>

      <!-- Linux Panel -->
      <div class="platform-panel" id="platform-linux">
        <div class="rule-table-wrap">
          <table class="rule-table">
            <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
            <tbody>
              <tr><td class="rule-name">block-system-file-modification</td><td><code>/etc/passwd</code>, <code>/etc/shadow</code>, <code>/etc/sudoers</code>, <code>visudo</code>, sudoers appends</td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-library-injection</td><td><code>LD_PRELOAD=</code>, <code>/etc/ld.so.preload</code>, <code>LD_LIBRARY_PATH</code> manipulation</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-mac-disablement</td><td><code>setenforce 0</code>, <code>aa-complain</code>, <code>aa-disable</code>, <code>systemctl mask apparmor</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-kernel-modification</td><td><code>sysctl -w kernel.randomize_va_space=0</code>, <code>modprobe</code>, <code>insmod</code>, <code>/proc/sys/</code> writes</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-systemd-persistence</td><td><code>systemctl enable</code> (non-workspace), unit files in <code>/etc/systemd/system/</code>, <code>systemctl mask</code> security services</td><td><span class="tier tier--2">T2</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            </tbody>
          </table>
        </div>
        <p class="platform-threats">Key threats: Kinsing malware using <code>/etc/ld.so.preload</code>. Kernel module rootkits. Crontab crypto miners.</p>
      </div>

      <!-- Windows Panel -->
      <div class="platform-panel" id="platform-windows">
        <div class="rule-table-wrap">
          <table class="rule-table">
            <thead><tr><th>Rule</th><th>What It Blocks</th><th>Tier</th><th>Action</th><th>Default</th></tr></thead>
            <tbody>
              <tr><td class="rule-name">block-defender-manipulation</td><td><code>Set-MpPreference -DisableRealtimeMonitoring</code>, <code>sc stop WinDefend</code>, broad exclusion paths</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-shadow-copy-deletion</td><td><code>vssadmin delete shadows</code>, <code>wmic shadowcopy delete</code>, <code>diskshadow delete shadows all</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-boot-config-changes</td><td><code>bcdedit /set recoveryenabled No</code>, <code>bcdedit /set testsigning on</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-uac-bypass</td><td>Registry + <code>fodhelper.exe</code>/<code>eventvwr.exe</code> technique, DelegateExecute creation</td><td><span class="tier tier--3">T3</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-powershell-cradles</td><td><code>IEX downloadString(...)</code>, <code>powershell -e</code> (encoded), PowerShell v2 downgrade</td><td><span class="tier tier--3">T3</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-event-log-clearing</td><td><code>wevtutil cl Security/System/Application</code>, <code>Clear-EventLog</code>, <code>ConsoleHost_history.txt</code> deletion</td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-lsass-sam-access</td><td><code>procdump -ma lsass.exe</code>, <code>mimikatz</code>, <code>reg save HKLM\SAM/SYSTEM/SECURITY</code></td><td><span class="tier tier--1">T1</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
              <tr><td class="rule-name">block-hidden-accounts</td><td><code>net user /add</code> + <code>net localgroup administrators /add</code> + registry hiding</td><td><span class="tier tier--3">T3</span></td><td><span class="action action--deny">deny</span></td><td><span class="default-badge default--on">on</span></td></tr>
            </tbody>
          </table>
        </div>
        <p class="platform-threats">Key threats: BlackCat/ALPHV, WannaCry, Conti using VSS deletion + Defender disablement + boot config changes. Trickbot UAC bypass via fodhelper. LSASS dumping for lateral movement.</p>
      </div>


      <!-- ============================================================
           IMPLEMENTATION ROADMAP
           ============================================================ -->
      <hr class="section-divider">
      <div id="roadmap" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num" style="background: rgba(0,212,255,0.1); border-color: rgba(0,212,255,0.2);">&rarr;</div>
        <h2>Implementation Roadmap</h2>
      </div>
      <p class="section-desc">Five engine tiers, from what&rsquo;s shipped to what&rsquo;s in research. Each tier unlocks a new class of rules.</p>

      <div class="roadmap">
        <div class="roadmap-item shipped">
          <div class="roadmap-dot"></div>
          <div class="roadmap-tier">Tier 1 &mdash; Shipped (v0.5)</div>
          <div class="roadmap-title">Substring Matching</div>
          <div class="roadmap-desc">12 rules in <code>rule_catalog.py</code> (3 base + 9 optional). All use <code>args_match</code> substring matching. Covers catastrophic shell/SQL, dangerous shell, destructive SQL/tools, package install approval, rate limits, file write approval, shell allowlist, sensitive file access.</div>
        </div>

        <div class="roadmap-item blocker">
          <div class="roadmap-dot"></div>
          <div class="roadmap-tier">Tier 2 &mdash; v1 Blocker</div>
          <div class="roadmap-title">Path Resolution</div>
          <div class="roadmap-desc">Expand <code>~/</code>, <code>$HOME</code>, <code>$USERPROFILE</code>, resolve <code>../</code>, resolve symlinks before matching. Without it, AvaKill has the same tilde-expansion blind spot that caused Claude Code&rsquo;s worst incident.</div>
          <div class="roadmap-rules">Unblocks ~15 rules: <code>block-catastrophic-deletion</code>, <code>block-deletion-outside-workspace</code>, <code>enforce-workspace-boundary</code>, <code>block-system-dir-writes</code>, <code>block-ssh-key-access</code>, <code>block-cloud-credentials</code>, <code>block-env-outside-workspace</code>, <code>block-symlink-escape</code>, <code>block-profile-modification</code>, <code>block-startup-persistence</code>, <code>block-launchagent-creation</code>, <code>block-systemd-persistence</code>, <code>block-ownership-changes</code>, <code>block-system-file-modification</code></div>
        </div>

        <div class="roadmap-item planned">
          <div class="roadmap-dot"></div>
          <div class="roadmap-tier">Tier 3 &mdash; Planned</div>
          <div class="roadmap-title">Command Parsing</div>
          <div class="roadmap-desc">Split compound commands on <code>&amp;&amp;</code>, <code>;</code>, <code>||</code>, <code>|</code>, <code>$()</code>, backticks. Evaluate each segment against rules independently.</div>
          <div class="roadmap-rules">Unblocks ~12 rules: <code>detect-obfuscation</code>, <code>detect-command-chaining</code>, <code>block-unqualified-dml</code>, <code>detect-mcp-tool-poisoning</code>, <code>block-uac-bypass</code>, <code>block-powershell-cradles</code>, <code>block-hidden-accounts</code>, <code>block-osascript-abuse</code>, <code>flag-postinstall-scripts</code>, <code>block-env-secret-exposure</code></div>
        </div>

        <div class="roadmap-item planned">
          <div class="roadmap-dot"></div>
          <div class="roadmap-tier">Tier 4 &mdash; Planned</div>
          <div class="roadmap-title">Cross-Call Analysis</div>
          <div class="roadmap-desc">Maintain session state across tool calls. Detect multi-step attack patterns: read credential file, encode contents, transmit via HTTP/DNS. Only Invariant Labs offers this capability &mdash; implementing it is a key differentiator.</div>
          <div class="roadmap-rules">Unblocks ~3 rules: <code>detect-encode-transmit</code>, <code>detect-behavioral-anomaly</code>, <code>block-clipboard-exfil</code></div>
        </div>

        <div class="roadmap-item planned">
          <div class="roadmap-dot"></div>
          <div class="roadmap-tier">Tier 5 &mdash; Research</div>
          <div class="roadmap-title">Heuristic / ML Detection</div>
          <div class="roadmap-desc">Entropy-based secret scanning, prompt injection detection in file contents, content-level credential commit scanning. Research-grade &mdash; high false positive rates need tuning per project. Ship as experimental/opt-in.</div>
          <div class="roadmap-rules">Unblocks: <code>detect-prompt-injection</code>, <code>detect-secrets-outbound</code>, <code>detect-credential-commit</code> content upgrade</div>
        </div>
      </div>


      <!-- ============================================================
           COMPETITIVE POSITIONING
           ============================================================ -->
      <hr class="section-divider">
      <div id="competitive" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num" style="background: rgba(0,212,255,0.1); border-color: rgba(0,212,255,0.2);">&#9733;</div>
        <h2>Competitive Positioning</h2>
      </div>
      <p class="section-desc">AvaKill fills 10 gaps no existing tool covers.</p>

      <div class="competitive-grid">
        <div class="competitive-card"><div class="competitive-num">1</div><h4>Default-deny for unknown tool calls</h4><p>Invariant/Snyk allows any tool not in rules. AvaKill&rsquo;s <code>default_action: deny</code> blocks unknown operations.</p></div>
        <div class="competitive-card"><div class="competitive-num">2</div><h4>Sequential tool call analysis</h4><p>Only Invariant offers this (Tier 4). AvaKill detects read-encode-transmit patterns across calls.</p></div>
        <div class="competitive-card"><div class="competitive-num">3</div><h4>Command normalization</h4><p>Cursor&rsquo;s denylist was bypassed via base64. AvaKill parses and normalizes commands before evaluation (Tier 3).</p></div>
        <div class="competitive-card"><div class="competitive-num">4</div><h4>Pre-shell-expansion validation</h4><p>Claude Code&rsquo;s worst bug: tilde expanded after validation. AvaKill resolves all expansions first (Tier 2).</p></div>
        <div class="competitive-card"><div class="competitive-num">5</div><h4>Interception + scanning + sandboxing</h4><p>No competitor combines tool-call interception with content scanning with OS-level sandboxing in one product.</p></div>
        <div class="competitive-card"><div class="competitive-num">6</div><h4>MCP security</h4><p>43% of public MCP servers have command injection flaws. AvaKill validates tool definitions, arguments, and outputs.</p></div>
        <div class="competitive-card"><div class="competitive-num">7</div><h4>Cross-platform consistency</h4><p>One policy language across Claude Code, Cursor, Gemini CLI, Codex, Windsurf &mdash; instead of 5 incompatible safety models.</p></div>
        <div class="competitive-card"><div class="competitive-num">8</div><h4>Three-tier approval workflows</h4><p>Auto-approve safe ops (<code>allow</code>), queue dangerous ones for review (<code>ask</code>), hard-block catastrophic ones (<code>deny</code>).</p></div>
        <div class="competitive-card"><div class="competitive-num">9</div><h4>Complete audit logging</h4><p>Claude Code&rsquo;s home deletion had no forensic trail. AvaKill logs full command, expanded args, rule match, and user decision.</p></div>
        <div class="competitive-card"><div class="competitive-num">10</div><h4>MCP supply chain integrity</h4><p>After the Postmark MCP incident and Smithery platform compromise, MCP server verification is critical and unaddressed.</p></div>
      </div>


      <!-- ============================================================
           RECOMMENDED DEFAULTS
           ============================================================ -->
      <hr class="section-divider">
      <div id="defaults" class="section-anchor"></div>
      <div class="section-head">
        <div class="section-num" style="background: rgba(34,197,94,0.1); border-color: rgba(34,197,94,0.2); color: var(--color-allowed);">&#10003;</div>
        <h2>Recommended Defaults</h2>
      </div>
      <p class="section-desc">The setup wizard&rsquo;s &ldquo;recommended&rdquo; configuration enables rules across 10 categories. Category-level toggles with these defaults would have prevented <strong>every documented incident</strong> in the 2024&ndash;2026 catalog.</p>

      <div class="defaults-table-wrap">
        <table class="defaults-table">
          <thead>
            <tr><th>Category</th><th>Default</th><th>Rules On</th><th>Action Mix</th></tr>
          </thead>
          <tbody>
            <tr><td class="cat-name">Filesystem Protection</td><td><span class="default-badge default--on">on</span></td><td>5 of 7</td><td><span class="action action--deny">deny</span></td></tr>
            <tr><td class="cat-name">Shell Safety</td><td><span class="default-badge default--on">on</span></td><td>7 of 11</td><td><span class="action action--deny">deny</span> <span class="action action--ask">ask</span></td></tr>
            <tr><td class="cat-name">Filesystem Write Protection</td><td><span class="default-badge default--on">on</span></td><td>4 of 4</td><td><span class="action action--deny">deny</span> <span class="action action--ask">ask</span></td></tr>
            <tr><td class="cat-name">Database Safety</td><td><span class="default-badge default--on">on</span></td><td>3 of 4</td><td><span class="action action--deny">deny</span></td></tr>
            <tr><td class="cat-name">Version Control Safety</td><td><span class="default-badge default--on">on</span></td><td>3 of 3</td><td><span class="action action--deny">deny</span></td></tr>
            <tr><td class="cat-name">Package &amp; Supply Chain</td><td><span class="default-badge default--on">on</span></td><td>2 of 3</td><td><span class="action action--ask">ask</span> <span class="action action--deny">deny</span></td></tr>
            <tr><td class="cat-name">Network &amp; Exfiltration</td><td><span class="default-badge" style="background: rgba(245,158,11,0.15); color: #F59E0B;">partial</span></td><td>4 of 8</td><td><span class="action action--deny">deny</span> <span class="action action--ask">ask</span></td></tr>
            <tr><td class="cat-name">Secrets &amp; Credentials</td><td><span class="default-badge default--on">on</span></td><td>7 of 7</td><td><span class="action action--deny">deny</span></td></tr>
            <tr><td class="cat-name">Cloud &amp; Infrastructure</td><td><span class="default-badge" style="background: rgba(245,158,11,0.15); color: #F59E0B;">partial</span></td><td>4 of 6</td><td><span class="action action--ask">ask</span> <span class="action action--deny">deny</span></td></tr>
            <tr><td class="cat-name">AI Agent Threats</td><td><span class="default-badge" style="background: rgba(245,158,11,0.15); color: #F59E0B;">partial</span></td><td>3 of 8</td><td><span class="action action--deny">deny</span></td></tr>
            <tr><td class="cat-name">OS Security Hardening</td><td><span class="default-badge default--on">on</span></td><td>all per platform</td><td><span class="action action--deny">deny</span> <span class="action action--ask">ask</span></td></tr>
          </tbody>
        </table>
      </div>

      <!-- Incident Coverage -->
      <div class="incident-coverage">
        <h3>Incident Coverage</h3>
        <ul class="incident-list">
          <li><span class="incident-name">Claude Code home directory deletion</span><span class="incident-rule"><code>block-catastrophic-deletion</code> + <code>enforce-workspace-boundary</code></span></li>
          <li><span class="incident-name">Gemini CLI file losses</span><span class="incident-rule"><code>block-deletion-outside-workspace</code></span></li>
          <li><span class="incident-name">Google Antigravity D: drive wipe</span><span class="incident-rule"><code>block-catastrophic-deletion</code></span></li>
          <li><span class="incident-name">Replit database deletion</span><span class="incident-rule"><code>block-catastrophic-sql</code></span></li>
          <li><span class="incident-name">Cursor YOLO cascading deletion</span><span class="incident-rule"><code>block-deletion-outside-workspace</code></span></li>
          <li><span class="incident-name">Amazon Q supply chain attack</span><span class="incident-rule"><code>block-agent-self-modification</code></span></li>
          <li><span class="incident-name">Kiro production outage</span><span class="incident-rule"><code>block-cloud-resource-deletion</code></span></li>
          <li><span class="incident-name">Claude Cowork photo deletion</span><span class="incident-rule"><code>enforce-workspace-boundary</code> (or <code>require-safe-delete</code>)</span></li>
        </ul>
      </div>

    </div><!-- .main-content -->
  </div><!-- .page-layout -->

  <!-- Footer -->
  <footer class="footer">
    <nav class="footer-links">
      <a href="https://github.com/log-bell/avakill/blob/main/docs/getting-started.md">Docs</a>
      <span class="sep">&middot;</span>
      <a href="https://github.com/log-bell/avakill">GitHub</a>
      <span class="sep">&middot;</span>
      <a href="https://pypi.org/project/avakill/">PyPI</a>
      <span class="sep">&middot;</span>
      <a href="https://github.com/log-bell/avakill/blob/main/CHANGELOG.md">Changelog</a>
      <span class="sep">&middot;</span>
      <a href="https://discord.gg/gTBvbkSV2">Discord</a>
    </nav>
    <div class="footer-attribution">
      Built with &#128737;&#65039; by AvaKill contributors.<br>
      Open-source under AGPL-3.0 license.
    </div>
    <hr class="footer-line">
  </footer>

  <script>
    // =========================================================
    // Navigation scroll effect
    // =========================================================
    const siteNav = document.getElementById('site-nav');
    window.addEventListener('scroll', () => {
      siteNav.classList.toggle('scrolled', window.scrollY > 10);
    }, { passive: true });

    // Hamburger toggle
    const hamburger = document.getElementById('nav-hamburger');
    hamburger.addEventListener('click', () => {
      siteNav.classList.toggle('nav-open');
    });

    // =========================================================
    // Intersection Observer for card animations
    // =========================================================
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry, i) => {
        if (entry.isIntersecting) {
          const delay = entry.target.dataset.delay || 0;
          setTimeout(() => {
            entry.target.classList.add('visible');
          }, delay);
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.1 });

    document.querySelectorAll('.info-card, .principle, .competitive-card, .roadmap-item').forEach((el, i) => {
      el.dataset.delay = (i % 5) * 60;
      observer.observe(el);
    });

    // =========================================================
    // Platform tabs
    // =========================================================
    document.querySelectorAll('.platform-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.platform-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.platform-panel').forEach(p => p.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById('platform-' + tab.dataset.platform).classList.add('active');
      });
    });

    // =========================================================
    // Active TOC tracking
    // =========================================================
    const tocLinks = document.querySelectorAll('.toc-list a');
    const sections = [];
    tocLinks.forEach(link => {
      const id = link.getAttribute('href').substring(1);
      const el = document.getElementById(id);
      if (el) sections.push({ id, el, link });
    });

    function updateToc() {
      let current = sections[0];
      for (const s of sections) {
        if (s.el.getBoundingClientRect().top <= 120) {
          current = s;
        }
      }
      tocLinks.forEach(l => l.classList.remove('active'));
      if (current) current.link.classList.add('active');
    }
    window.addEventListener('scroll', updateToc, { passive: true });
    updateToc();
  </script>

</body>
</html>
